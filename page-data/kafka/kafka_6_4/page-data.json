{"componentChunkName":"component---src-templates-blog-post-js","path":"/kafka/kafka_6_4/","result":{"data":{"site":{"siteMetadata":{"title":"Devlog","author":"JonginPark","siteUrl":"https://SiverPineValley.github.io","comment":{"disqusShortName":"","utterances":"SiverPineValley/devlog"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"04e0f7dd-1978-5731-85de-86b00b693049","excerpt":"6-4-1) 카프카 버로우 버로우는 링크드인에서 개발하여 오픈소스로 공개한 컨슈머 랙 체크 툴로서 RestAPI…","html":"<h2 id=\"6-4-1-카프카-버로우\" style=\"position:relative;\"><a href=\"#6-4-1-%EC%B9%B4%ED%94%84%EC%B9%B4-%EB%B2%84%EB%A1%9C%EC%9A%B0\" aria-label=\"6 4 1 카프카 버로우 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6-4-1) 카프카 버로우</h2>\n<ul>\n<li>버로우는 링크드인에서 개발하여 오픈소스로 공개한 컨슈머 랙 체크 툴로서 RestAPI를 통해 컨슈머 그룹 별로 컨슈머 랙을 확인할 수 있다. 외부 모니터링 툴을 사용하면 카프카 클러스터에 포함된 모든 컨슈머, 토픽들의 랙 정보를 한번에 모니터링할 수 있다는 장점이 있다. 또한, 모니터링 툴들은 클러스터와 연동되어 컨슈머의 데이터 처리와는 별개로 지표를 수집하기 때문에 데이터를 활용하는 프로듀서나 컨슈머의 동작에는 영향을 주지 않는다.</li>\n<li>버로우는 다수의 클러스터에 연결하여 동작할 수 있다. 버로우를 카프카 클러스터에 연동하면 REST API를 통해 컨슈머 그룹 별 랙을 조회할 수 있다.</li>\n</ul>\n</br>\n<h2 id=\"6-4-2-컨슈머-랙-이슈-판별\" style=\"position:relative;\"><a href=\"#6-4-2-%EC%BB%A8%EC%8A%88%EB%A8%B8-%EB%9E%99-%EC%9D%B4%EC%8A%88-%ED%8C%90%EB%B3%84\" aria-label=\"6 4 2 컨슈머 랙 이슈 판별 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6-4-2) 컨슈머 랙 이슈 판별</h2>\n<ul>\n<li>버로우의 기능 중 가장 돋보이는 점은 컨슈머와 파티션의 상태를 단순히 랙의 임계치(threshold)로 나타내지 않았다는 점이다. 특정 파티션의 랙이 100만이 넘었다고 해서 단순히 컨슈머 또는 파티션에 문제가 있다고 단정지을 수 없다. 왜냐하면 프로듀서가 데이터를 많이 보내면 일시적으로 임계치를 넘어가는 현상이 발생할 수 있기 때문이다. 컨슈머 애플리케이션을 운영할 때 컨슈머 랙이 임계치에 도달할 때마다 알람을 받는 것은 무의미한 일이다.</li>\n</ul>\n</br>\n<h3 id=\"6-5-2-1-컨슈머-랙-평가-evaluation\" style=\"position:relative;\"><a href=\"#6-5-2-1-%EC%BB%A8%EC%8A%88%EB%A8%B8-%EB%9E%99-%ED%8F%89%EA%B0%80-evaluation\" aria-label=\"6 5 2 1 컨슈머 랙 평가 evaluation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6-5-2-1) 컨슈머 랙 평가 (Evaluation)</h3>\n<ul>\n<li>버로우는 단순히 임계치를 통해 판별하는 것이 아닌 슬라이딩 윈도우 (Sliding Window) 계산을 통해 문제가 생긴 파티션과 컨슈머의 상태를 표현한다. 이렇게 버로우에서 컨슈머 랙 상태를 표현하는 것을 컨슈머 랙 평가 (evalution)이라고 한다. 컨슈머 랙과 파티션의 오프셋을 슬라이딩 윈도우로 계산하면 상태가 정해진다. 결과적으로 파티션의 상태를 OK, STALLED, STOPPED로 표시하고, 컨슈머의 상태를 OK, WARNING, ERROR로 표시한다.</li>\n</ul>\n</br>\n<h3 id=\"6-5-2-2-정상적인-상태\" style=\"position:relative;\"><a href=\"#6-5-2-2-%EC%A0%95%EC%83%81%EC%A0%81%EC%9D%B8-%EC%83%81%ED%83%9C\" aria-label=\"6 5 2 2 정상적인 상태 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6-5-2-2) 정상적인 상태</h3>\n</br>\n<div align=\"left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 564px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABtklEQVR42m1SyYrCQBTM/9/FDxB0QJ25qMlkiLtJVNSIcd/3XRC9KEKN9SQyhzkU3S/pV11Vr5XZbIZer4fhcIjRaPQv+O8vJpMJptMpxuOx7Il2u43H4wFlsVggn8+j2Wxis9mA9XK5FHBPrFYr+bfdbgWdTgeu66JQKCCZNJDJpGFbNu73OxQ21mo1uZlNHtl6vcZ+v8dutxMFJCGBz+eDaZqoVCowjCTi8bhA07SXQkpPpVIin7cfj0chYRTVahW2bSMQCCCbzaJcLss6n8/lLJXzYp53HOelsP/MLxgMijWSs4Ek4XAYfr8f3W73bdmzzdpzQrB+Ew4GA4RCH7AsSyzpui55MmTapAKq5WVcPVAl4WVMN0LID2bBRL/fx+l0wuVywfl8FhueosPhIHkSbPZAdcyXHG+F/Eh2DoaqSqWSZKp/61ATKjLpjKhnFMaPAU3VkEgkxMln9AuxWAxu05Wp3243KJwurXFqJGWzYRgyAKfuIBqJQFXV59PKIZfLyRnCqdef07bkDVNhsVjE9XqFQslkJynBITBXrqydmgO34aL7bGTdarXeoCPm3Wg0BLT8C2xqwDw+EOmHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"normal graph\" title=\"\" src=\"/static/515a81bb8726d87e1e27af3e4e0f8f76/ba4d9/normal_graph.png\" srcset=\"/static/515a81bb8726d87e1e27af3e4e0f8f76/5a46d/normal_graph.png 300w,\n/static/515a81bb8726d87e1e27af3e4e0f8f76/ba4d9/normal_graph.png 564w\" sizes=\"(max-width: 564px) 100vw, 564px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</div>\n</br>\n<ul>\n<li>일반적으로 컨슈머를 운영하면서 자주 볼 수 있는 그래프이다. 이렇게 컨슈머 랙이 낮은 상태가 유지되거나 거의 없는 경우 버로우는 파티션은 OK, 컨슈머도 OK로 표현한다.</li>\n</ul>\n</br>\n<h3 id=\"6-5-2-3-컨슈머-처리량-이슈\" style=\"position:relative;\"><a href=\"#6-5-2-3-%EC%BB%A8%EC%8A%88%EB%A8%B8-%EC%B2%98%EB%A6%AC%EB%9F%89-%EC%9D%B4%EC%8A%88\" aria-label=\"6 5 2 3 컨슈머 처리량 이슈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6-5-2-3) 컨슈머 처리량 이슈</h3>\n</br>\n<div align=\"left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABh0lEQVR42oWSx44CQQxE5/9/gSscuCC4IJFEzkLAkHOcIQl+oXafR420pz2UZtp2l8vl9vb7vZbLpTabjU6nk47H4784n8+6Xq9WfzgcDPyPRiN5JJvNpubzuZ7Pp8Iw1O12M/Dv8Hg8LH+/34WI6XSq2WymarWqTqejcrmsdrstD+bxeKzdbmfFdA6CwPB6vQzEya9WK+VyOWWzWSMkxhes12tVKhV5BGu1mrbbramCADVgOBxas0QioVgsJt/3VSgUlM/nbUTuoBBlIJPJyIM9Ho+bMpRAgBetVkvJZNLG6fV6dibvfKYeK7CB5u/3O/IQ71DQ7XatSyqVMiVcggDVTrFbBrhcLgas4Uy+3+/Lw+BSqWTjkXAjuy1CEi0m+CUP/yyLGl4H3lI3GAyiLUOGIsjchiFFIXmeBaZzkbGwgIkmk4l5WCwWv1aZQtbfaDS+hQ74l06nzWMMB1yu1+u2SCxiOpp9Pp9oZDwkAKl7AoDu5CiChMe/WCws5t4gX/wmxugs7gfHCr2uqrY6GwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"consumer throghput issue\" title=\"\" src=\"/static/50a3dec90ca51e6011c87666ae57c671/c1b63/consumer_throghput_issue.png\" srcset=\"/static/50a3dec90ca51e6011c87666ae57c671/5a46d/consumer_throghput_issue.png 300w,\n/static/50a3dec90ca51e6011c87666ae57c671/0a47e/consumer_throghput_issue.png 600w,\n/static/50a3dec90ca51e6011c87666ae57c671/c1b63/consumer_throghput_issue.png 1200w,\n/static/50a3dec90ca51e6011c87666ae57c671/e9140/consumer_throghput_issue.png 1226w\" sizes=\"(max-width: 1200px) 100vw, 1200px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</div>\n</br>\n<ul>\n<li>프로듀서가 추가하는 최신 오프셋에 비해 컨슈머 오프셋이 따라가지 못하는 추이를 볼 수 있다. 이런 그래프가 나오는 이유는 컨슈머의 데이터 처리량이 프로듀서가 보내는 데이터 양에 비해 적기 때문이다. 이 경우 파티션은 OK, 컨슈머는 WARNING 상태로 나타낸다.</li>\n</ul>\n</br>\n<h3 id=\"6-5-2-4-컨슈머-이슈\" style=\"position:relative;\"><a href=\"#6-5-2-4-%EC%BB%A8%EC%8A%88%EB%A8%B8-%EC%9D%B4%EC%8A%88\" aria-label=\"6 5 2 4 컨슈머 이슈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6-5-2-4) 컨슈머 이슈</h3>\n</br>\n<div align=\"left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAABo0lEQVR42mWS147iQBBF/f//wBsSiDcWCY0JIpmcwSYNOUfxCXc4pfVqpH246m5Xdd9Qdubzufr9vqbTqdbrtVar1X9YLpf/wHm322m73Vp/4Afyg0DBJFCtVpOz3+9VKpXEw4/HQ5fLRdfr1cD+fD7rfr/r+Xrq+XzqcDgY+WAwMNSrdXkVT17Js9WBiQLMPHA8Hg3sIQDU6MGJ67pKJv981H4LMafTyQBpu92WM5vNlMvlTP7tdjMVAFudTkfdblf5fF7pdFqbzcYuv99v64WUFTev10u9Xk8OrLFYzIqo9TxP1WrVYohGo5pMJpbd+u9ji8VCvu+bdRRiH1FEBrGDlUgkokajoXq9rlQqZda4RAPNhJ3JZEwhfYVCwWIYjUbKZrNyv1wVi8VPFEk5FLgQfCZFDtgJh/PbDkARLobDoeXFCgHECOBsQ6GIFWyggm+APZaazaZFgYpyuWwDIorw9+FPQESr1ZLDMCiSGxdhBOEj8XhciUTCbHKB76xhj+tmNP+IwYFNmRywy6OAfQjUkWelUrEsf9fCXtbxeGyWUf8DnyG6At3nOtAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"consumer issue\" title=\"\" src=\"/static/d225b11cc51f23c8b9ca92aabf32cfab/c1b63/consumer_issue.png\" srcset=\"/static/d225b11cc51f23c8b9ca92aabf32cfab/5a46d/consumer_issue.png 300w,\n/static/d225b11cc51f23c8b9ca92aabf32cfab/0a47e/consumer_issue.png 600w,\n/static/d225b11cc51f23c8b9ca92aabf32cfab/c1b63/consumer_issue.png 1200w,\n/static/d225b11cc51f23c8b9ca92aabf32cfab/89048/consumer_issue.png 1242w\" sizes=\"(max-width: 1200px) 100vw, 1200px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</div>\n</br>\n<ul>\n<li>최신 오프셋이 지속적으로 증가하지만, 컨슈머 오프셋이 멈춘 상태이다. 이로 인해 컨슈머 랙이 증가하고 있는데, 컨슈머가 어떠한 이유로 데이터를 가져가지 않고 있는 것이다. 이 경우 파티션은 STALLED, 컨슈머는 ERROR 상태로 표신된다.</li>\n</ul>","frontmatter":{"title":"6-4) 버로우","date":"January 11, 2024"}}},"pageContext":{"slug":"/kafka/kafka_6_4/","previous":{"fields":{"slug":"/kafka/kafka_6_3/"},"frontmatter":{"title":"6-3) 컨슈머 랙"}},"next":{"fields":{"slug":"/flutter/flutter_4/"},"frontmatter":{"title":"[Flutter] 04. Provider Access"}}}},"staticQueryHashes":["3128451518","643154061"],"slicesMap":{}}