{"componentChunkName":"component---src-templates-blog-post-js","path":"/kafka/kafka_8_2/","result":{"data":{"site":{"siteMetadata":{"title":"Devlog","author":"JonginPark","siteUrl":"https://SiverPineValley.github.io","comment":{"disqusShortName":"","utterances":"SiverPineValley/devlog"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"687c139c-cba9-53ae-8aa9-dc14c3059c38","excerpt":"8-2-1) KStream 은 레코드의 흐름을 표현한 것으로 메시지 키와 메시지 값으로 구성되어 있다. KStream으로 데이터를 조회하면 토픽에 존재하는(또는 KStream에 존재하는) 모든 레코드가 출력된다. 컨슈머로 토픽을 구독하는 것과 동일하다고 볼 수 있다. 8-2-2) KTable 은 KStream과 다르게 메시지 키를 기준으로 묶어서 사용한다. KTable은 유니크한 메시지 키를 기준으로 가장 최신 레코드를 사용한다. 그러므로 KTable…","html":"<h2 id=\"8-2-1-kstream\" style=\"position:relative;\"><a href=\"#8-2-1-kstream\" aria-label=\"8 2 1 kstream permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8-2-1) KStream</h2>\n<div align=\"left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 450px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 104.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAABYlAAAWJQFJUiTwAAADNUlEQVR42m2UB08jMRSE91fDbwAJgUCA6CT0FhR6751Qk9A7iN57f8c3kbm96FZ62thZj2fmje19fX0ZxfP9/a1yc5+fnxq/vr7azs6ObW9vq/b29mx/f19vN7+1tWWHh4fmRSIR6+zstJGREevt7bXBwUEBAAQgz8XFhZWVlVkgELBgMGhZWVmWlpZmGRkZVlRUpLny8nKrrKw0b3V11WKxmG1ubtr8/LwtLCzY8/OzAD8+PgR4fn5uFRUVVlNTY7W1tQLJycmx3NxcgTFXXV2t8k5OTkT34OBAC29ubuzl5UVAzorLy0t9DMvS0lKBUDBmXFxcrLEAb29vJWlpaUmgV1dXdnd3Z09PT/b4+Ghvb2/yKzMz07q7u1Wtra3W1dUliwYGBmx0dNTq6uoSklnAMzw8rIXX19diSrHR/f29bWxsWHp6uvX09Aisvr7ewuGwAIeGhmxsbOwvIHKi0ai8Ozo6kjyagX/OQ+bwr7CwUP4hs6SkxAoKCiw/P9/y8vJkB994dBSW6+vrkggIgNT7+7sAsQGgvr4+Sezo6BDb/v5+Gx8ft8nJSWtubk4wpAGYT3wcQyf59PRUFiA5JSVF35AIQKenp+U7KSGL7e3taoyH+QDiIYthyya8iQ+MSQKdbGtrk2/EhN80iAwzh69iSGTYmQyura3Z7u6u0XnkOsDj42PtzoKqqqrfPJJNijn+k4cPDw/yDuoA4Sn++Y8kHtKQqakpm5mZkZdEZXZ2Vus4FL+SXSfn5uYUG6JydnamQipgNAwPiQhqiA4W0QyKuVAolJDszis7wpbHddkfG+IBo8XFRZ13mkLUVlZWZBVeIt+D0fLyssXjcd0ejP23jQMke01NTSpC3NDQYI2NjQo4jDl2eKkc0mlkcSpoxv8Y4iHe0VEyh2eMkQxbNvpHMl3mPvN7SA7xEEmpqamSTAOwB+mookgKG0iyA+Q+dB4mSwYUDwGCEX7RoImJid/IhVtaLPhz+3gs5O5Dtj8uyYAEm8iwmJMCML85OdjFcQwGgglAB+oHS25Kdna2ooF/5I3fLT+sODFcZVwObOr5FycDuo1oFBklxBSe8iYy7g1L7tM/W56tmJCNS5QAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"kstream\" title=\"\" src=\"/static/8dc8adb3ce84c5e80cec590b7563aacb/fc2a6/kstream.png\" srcset=\"/static/8dc8adb3ce84c5e80cec590b7563aacb/5a46d/kstream.png 300w,\n/static/8dc8adb3ce84c5e80cec590b7563aacb/fc2a6/kstream.png 450w\" sizes=\"(max-width: 450px) 100vw, 450px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</div>\n<br>\n<ul>\n<li><code class=\"language-text\">KStream</code>은 <strong>레코드의 흐름을 표현한 것으로 메시지 키와 메시지 값으로 구성되어 있다</strong>. KStream으로 데이터를 조회하면 토픽에 존재하는(또는 KStream에 존재하는) 모든 레코드가 출력된다. 컨슈머로 토픽을 구독하는 것과 동일하다고 볼 수 있다.</li>\n</ul>\n</br>\n<h2 id=\"8-2-2-ktable\" style=\"position:relative;\"><a href=\"#8-2-2-ktable\" aria-label=\"8 2 2 ktable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8-2-2) KTable</h2>\n<div align=\"left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 464px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 98%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAADEUlEQVR42l2UV0stQRCE9z/7JAjii6D4YEJREXPOGTHnnDAnEBVzzrnkq8N4D3ehmdk5Z2uqv+6Z6PPzU8T397fHr68vz0P8/Pzo/f1da2trf7G+vq7t7W0H8/jfouHhYXV0dGhgYECtra0aHR3V29ubhRDnub+/V2FhoUpKSlRaWup5SkqKkpOTVVBQ4LWysjLl5uYqWl1d1e7urndbXl72Lq+vrxbEMc/Dw4M/qqmpUW1trSorK5WXl6ecnBxVVFR4va6uzhtFx8fHFjw6OtL5+bmur6/18fFhIVLmeXp6skh5ebmdMK+urlZVVZU3wjlrFkTg9PRUS0tLQhzRu7s7PT4+2tnLy4tOTk6Unp6uzs5O9fT0qKWlxZiY9/f3C2zt7e12HQEcVr29vbq4uLBDxhCIHx4eKjU11SJwxl19fb03QHBkZOSfII6oFCxxgiCpskkoCimH9GAW0iX94uJiB+tFRUWKKACpbW5uuj2C49BOFIff4dPW1mZXuGtubv5DMDQ0pK6urliVESSmpqbMMsTZ2ZlH0t7b21NCQoIGBwe1srJiPIjMz89rcXFROzs7mpiYUGZmZowhfQdYhJkzsh7Gm5sb9xtCc3NzdoYgJhhnZmbM0gxRZ1eqzHx/f9/MSDekf3t7a34w4iPSJ/Lz8/1OwNEMOQWhMAjhKvQf/EJRKADcqGZDQ4PnMOUdx1TfDvkIgYWFBbcIVb66uvoL3NE2iYmJbg+y4ZiOjY2ZH+9kNj09HWMYBPkTTmjk5+dnB+8wvby8VEZGhitKIWhseMIQ9nDt6+tTdna2IqrJDjgMjRxumfijR8r0Gv1HH3J+OW5hnTmFixDgHHM58CGBWLwgboEejlpgiSswjI+Pe90Ow8c4hBcMSTEEawcHB0pKSnIfbmxs+GMY0hkg2NrasmhWVpYiXHC78CecwDA+aB2Kk5aW5rsSPPCenZ31VUdhaPzJycmYw3BucRHc/p8yGOg7WoMW4RqjdUDQ3d3tDUDgKsdf9fFXf9iIB6dw43LlIm1qalJjY6PnrBGcb8Zf1QtX+0RBeTIAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"ktable\" title=\"\" src=\"/static/1ed08cd05db231a71ea423b302ceedf2/69096/ktable.png\" srcset=\"/static/1ed08cd05db231a71ea423b302ceedf2/5a46d/ktable.png 300w,\n/static/1ed08cd05db231a71ea423b302ceedf2/69096/ktable.png 464w\" sizes=\"(max-width: 464px) 100vw, 464px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</div>\n<br>\n<ul>\n<li><code class=\"language-text\">KTable</code>은 KStream과 다르게 메시지 키를 기준으로 묶어서 사용한다. <strong>KTable은 유니크한 메시지 키를 기준으로 가장 최신 레코드를 사용한다</strong>. 그러므로 KTable로 데이터를 조회하면 메시지 키를 기준으로 가장 최신에 추가된 레코드의 데이터가 출력된다. 새로 데이터가 적재될 때 동일한 메시지 키가 있는 경우 데이터가 업데이트 되었다고 볼 수 있다.</li>\n</ul>\n</br>\n<h2 id=\"8-2-3-코파티셔닝co-partitioning\" style=\"position:relative;\"><a href=\"#8-2-3-%EC%BD%94%ED%8C%8C%ED%8B%B0%EC%85%94%EB%8B%9Dco-partitioning\" aria-label=\"8 2 3 코파티셔닝co partitioning permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8-2-3) 코파티셔닝(co-partitioning)</h2>\n<div align=\"left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 364px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 86.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAAC00lEQVR42o2UV0trURSEz6/1QcWCBiJGLFgwikZFH+xix96NFbH39mIXETHYsfe5fEsS9HLhemBl97VnZs2OMz09rcHBQXV2dqqtrU1DQ0Pq7+/X1dWV+N7f3/Xx8fHrcJqbm1VYWKjo6GhFRkZa3+fzaW9v70dC2t+EA6qkpCR5PB4lJycrJSVF+fn5Ojw8/JHw8/NT//vY47S0tKi9vd0od3R0qLe3VyUlJTo6OrJNb29ven191fn5uc7OznRxcWF92svLy1Cftdvb2y+EU1NTGh0d1cTEhJaWlpSZmanx8XE9PT1Z0oeHBxUXFys+Pl5RUVFKTExURESEwsLCFBcXp9jYWMXExKivr09OU1OTGhsb1d3dbShBXFBQoJmZGa2vr2tlZUU7OzsqLy9XZWWlsrOzjQGy5OTkhDTPy8uzHIYQNAMDA4aSJCxubW0ZOlBubGwoISHBkh0cHJgT5ubm7Nzq6qqtd3V1GSCrMjZh08jIiNHOysqyDZubmwoEApYUGSje9va2sNr8/LxmZ2e1trZmLIJ1MMrp6enKyMhQamqqtSA8OTnR3d2d0YWqy+WyC4kgAL/fb+OxsTFLZgn5qampMdsgekVFhUpLS8022GV5eVm7u7tKS0tTeHi4Tk9PjSrFAyX7YAJCXOJAzev1yu12m7lBSFKoQAlrgJZ5kKAdATIS019YWFBPT4+F+bC2tlYNDQ2qr6+3KiM+N+K/4+NjOwxqDlL94eFhY8WZyclJQ0otABfyIbezCMXc3FyjQkURnKJwWVlZmaqqqixIWF1dbfoyxkpo6uDB1tZWEzr4WoqKiuzFkJAPLTE3fxhI8Hd7c3Oj+/t7vby8fCHEg/DHh4uLi2YR9ON7fHzU8/OzbUYCWsbfg3meqCWsq6szNDwbUEKdl7K/v29/DCAjSEz8a4wkwTmHlwF3KgZCBCeur69DLyV4OBjMfQ9QMg/CP3xUa52feGRlAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"co partitioning\" title=\"\" src=\"/static/915963de9b456a1c39c501acb3bcb883/e45a9/co-partitioning.png\" srcset=\"/static/915963de9b456a1c39c501acb3bcb883/5a46d/co-partitioning.png 300w,\n/static/915963de9b456a1c39c501acb3bcb883/e45a9/co-partitioning.png 364w\" sizes=\"(max-width: 364px) 100vw, 364px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</div>\n<br>\n<ul>\n<li>KStream과 KTable 데이터를 조인한다고 가정하자. KStream과 KTable을 조인하려면 반드시 <code class=\"language-text\">코파티셔닝(co-partitioning)</code>되어 있어야 한다. <strong>코파티셔닝이란 조인을 하는 2개의 데이터의 파티션 개수가 동일하고 파티셔닝 전략(partitioning strategy)를 동일하게 맞추는 작업이다</strong>. 파티션 개수가 동일하고 파티셔닝 전략이 같은 경우에는 동일한 메시지 키를 가진 데이터가 <strong>동일한 태스크에 들어가는 것을 보장</strong>한다.</li>\n</ul>\n</br>\n<blockquote>\n<p>파티션 개수, 파티션 전략이 동일해야 코파티셔닝이 가능하다.</p>\n</blockquote>\n</br>\n<ul>\n<li>문제는 조인을 수행하려는 두 토픽의 파티션 개수나 파티션 전략이 다를 경우 발생한다. 이런 경우 조인을 수행할 수 없고, 코파티셔닝이 되지 않은 2개의 토픽을 조인하려는 로직이 담긴 스트림즈 애플리케이션을 실행하면 <code class=\"language-text\">TopologyException</code>이 발생한다.</li>\n</ul>\n</br>\n<h2 id=\"8-2-4-globalktable\" style=\"position:relative;\"><a href=\"#8-2-4-globalktable\" aria-label=\"8 2 4 globalktable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8-2-4) GlobalKTable</h2>\n<div align=\"left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 440px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 85%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABYlAAAWJQFJUiTwAAACj0lEQVR42o1UTUtCURTs37YJEtQgzQQ3QpiKVFZqaYvwM+lDKS3K1MiVVJaWCwVFhaKNppXZxJx4D91EF8bn854758yc450ajUb4+vpCo9FArVYT1Ot1wefnJ76/v8GY/2KKB97f3xEOh+F0OjE3NweXy4XNzU20221wMSGDh8OhgO/KcxwqISvZ3t7GwsICDAYDFhcX4XA4JggZ99dSlKgVhkIhxGIx7O/v4/DwEG63G51ORw1utVp4eHjA09MTHh8fUalU1Ge5XMbr66vEqoTRaBSnp6e4uLhALpcT+efn53h+fhZ53GP1Wq1WFExPT0On0wn0ej2y2ewk4e7urlrlwcEBVlZWpDFKZV6vV3zlXiQSkQL29vbknXuZTOaXkB+DwUA2meXq6gq3t7dCyPdutyveMNHMzAyq1SouLy9FRbFYFNkkpxqVkPrX19exvLwMm80Gu92OpaUlOcAxok9MQF+ZJJ1OC0jCyjghE4R3d3fweDzS2dnZWSHb2NjA8fGxBL28vMBqtUKj0Yh8kpHo5uZGEAwGxXuVsFQqwWg0wmw2w2QywWKxYH5+HslkUhpSKBTEPxLRjnw+L5NwfX0tZ+njhIf39/cIBAISlEgkkEqlxGh6RdnscDwel0q4zwbSIkqlirW1NZydnU0ScrAVb4idnR0JZHYONjtOn+ghK2R1bAzB35rN5i8hO0gZJGSFR0dHQuj3+8VXTsDHx4f8m7gYz1FT/hnKojUcP6mQhCQ4OTkRMOPW1pYqg6Pz9vYm6PV66vfx30jGxELIzpGQ/tATkvp8PqmUi4f6/b5UyycPj4NE6m3DA2w9Z4xyCTZldXVVEihyxm+UP68vHuAlwKooUQHJ2Kzx6+s/+AFeT5QphUrYaQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"global ktable\" title=\"\" src=\"/static/f978fb0648c88568d84646d5a57fa3ca/48c0e/global_ktable.png\" srcset=\"/static/f978fb0648c88568d84646d5a57fa3ca/5a46d/global_ktable.png 300w,\n/static/f978fb0648c88568d84646d5a57fa3ca/48c0e/global_ktable.png 440w\" sizes=\"(max-width: 440px) 100vw, 440px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</div>\n<br>\n<ul>\n<li>코파티셔닝되지 않은 KStream과 KTable을 조인해서 사용하고 싶다면 KTable을 <code class=\"language-text\">GlobalKTable</code>로 선언하면 된다. GlobalKTable은 코파티셔닝되지 않은 KStream과 데이터를 조인할 수 있다. 왜냐하면 KTable과 다르게 GlobalKTable로 정의된 데이터는 스트림즈 애플리케이션의 모든 태스크에 동일하게 공유되어 사용되기 때문이다.</li>\n<li>모든 케이스에서 GlobalKTable을 조인하면 KTable에서 조인의 문제를 해결할 수 있으나, GlobalKTable은 파티션에 있는 모든 태스크에 공유되므로 큰 용량을 사용할 경우 부담이 될 수 있다. 따라서 용량이 작은 경우에만 선택적으로 사용하는 것이 바람직하다.</li>\n</ul>","frontmatter":{"title":"8-2) KStream, KTable, GlobalKTable","date":"January 21, 2025"}}},"pageContext":{"slug":"/kafka/kafka_8_2/","previous":{"fields":{"slug":"/kafka/kafka_8_1/"},"frontmatter":{"title":"8-1) 카프카 스트림즈"}},"next":{"fields":{"slug":"/kafka/kafka_8_3/"},"frontmatter":{"title":"8-3) 스트림즈DSL 중요 옵션(필수 옵션)"}}}},"staticQueryHashes":["3128451518","643154061"],"slicesMap":{}}