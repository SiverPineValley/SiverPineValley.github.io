{"componentChunkName":"component---src-templates-blog-post-js","path":"/kafka/kafka_8_4/","result":{"data":{"site":{"siteMetadata":{"title":"Devlog","author":"JonginPark","siteUrl":"https://SiverPineValley.github.io","comment":{"disqusShortName":"","utterances":"SiverPineValley/devlog"},"sponsor":{"buyMeACoffeeId":""}}},"markdownRemark":{"id":"8768c71b-c272-5a5d-bd1d-947f49120415","excerpt":"8-4-1)  스트림즈 애플리케이션 - 필터 : 파라미터로 들어온 토픽의 데이터를 KSteram 구조체로 가져오기 위한 소스 프로세서. : 파라미터로 들어온 필터링 메서드를 사용하여 특정 메시지 값을 필터링하기 위해 사용. : 특정 토픽으로 DSL을 적용한 레코드를 저장한다. 8-4-2) KTable과 KStrem을 join() KTable과 KStream…","html":"<h2 id=\"8-4-1--스트림즈-애플리케이션---필터\" style=\"position:relative;\"><a href=\"#8-4-1--%EC%8A%A4%ED%8A%B8%EB%A6%BC%EC%A6%88-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98---%ED%95%84%ED%84%B0\" aria-label=\"8 4 1  스트림즈 애플리케이션   필터 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8-4-1)  스트림즈 애플리케이션 - 필터</h2>\n<div align=\"left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 364px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 134.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAABYlAAAWJQFJUiTwAAADM0lEQVR42p2VWUsrQRCF58cLPgnRiGtc4oIrGk1UfFARd0UTNdEkGpegUSQQFdyXun4lNcydTO7DLSi6Z7r7dFWdqmrn6+tLTD8/PwV5eHiQfD4vFxcXcnZ2JsfHx6q5XO5H8zqm02kpFApyeXkp2WxWSqWSnnWCAFnc2NiQTCYjyWRSxsbGpLe3V6an4zI+Pi5DQ0P6b2dnR8GWl5dlZWXlFxAQ04+PDwV+enqS/f19SaVSqoDmcllJJBIKdnp6KqlkSg4PD+Xg4EB2d3fl+vr6F/D7+1snjF71C/8WFhbUMi68Ld1qaLzrGOO8v7/L6+urq3yjLy8vOiLMcTUajcrg4KB0dnZK+iccAOMViocKeHJy8hObaZmfn5epqSkZHR1VBYA1BNdaWlqkqalJmpubdY7rWGVApg7sTU5OyszMjAuIWwBCytvbm8YRkFAoJI2NjdLR0SHd3d3qgbnqAuImLjFy2FxG2YCwxkVdXV3S398vDQ0Nsr6+rmtVFtphP9t2M3Pk8fFR5ubmNI5Y7AdyAb1AfrVNBnp0dKSpg5gHVYDmVpCYtQgVgdtYSEIboN8Ip1wuS7FY1AOMpnxXKhXddHd3p/EbGBhQ0NbWVllbW9OwEP/n52dV0sjZ3t7WsoI5cow5DJIelBSxgwD+1dXVSX19vVrJPgAg0ghldM7Pz2V1dVVrd2trSzY3N9UlQK6urtRdGkR7e7sCwTKJzYgEkmLlxg/v6J0vLS1JJBJR18PhsF4SmDa16A/qQlg+PDysrvoT+i9Aq0evei8yQDrL7OxsoGUuYFBn8XYQU2La09OjZFCW9/f3wS7TTI0IFGJQSLq5udFDEEcW9PX1KRkQFI/HgwFpAGxgM0qOtbW1afD39vY0FQAHiAZBHRNH1kmVquaA6aQH1niVDkwOIiQ/DAM6MjKiHYfOFGjhv2LorWN6I3lIwhNDujVnjUC3wdZqDN6LrN7pndYcgnqA2xz86UGe2TNJt0YBg6zFxUVNH/7xOPHcsgZxNZ9RmgJ1zMtnT+jExITOGUmfWCymz4BlBBdVAVqZwZ7d/Pu45/T9tQefNb6JKyPeuM9orXL7H+HcH3bWr4by7yWRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"streams application filter\" title=\"\" src=\"/static/e287d169ad36b8703a8c38d1f37ff827/e45a9/streams_application_filter.png\" srcset=\"/static/e287d169ad36b8703a8c38d1f37ff827/5a46d/streams_application_filter.png 300w,\n/static/e287d169ad36b8703a8c38d1f37ff827/e45a9/streams_application_filter.png 364w\" sizes=\"(max-width: 364px) 100vw, 364px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</div>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example</span><span class=\"token punctuation\">;</span>  \n  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>serialization<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Serdes</span></span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>streams<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">KafkaStreams</span></span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>streams<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamsBuilder</span></span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>streams<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamsConfig</span></span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>streams<span class=\"token punctuation\">.</span>kstream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">KStream</span></span><span class=\"token punctuation\">;</span>  \n  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Properties</span></span><span class=\"token punctuation\">;</span>  \n  \n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">StreamsFilter</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">APPLICATION_NAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"streams-filter-application\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">BOOTSTRAP_SERVERS</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"my-kafka:19092\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">STREAM_LOG</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"stream_log\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">STREAM_LOG_FILTER</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"stream_log_filter\"</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n  \n        <span class=\"token class-name\">Properties</span> props <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Properties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_ID_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">APPLICATION_NAME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BOOTSTRAP_SERVERS_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">BOOTSTRAP_SERVERS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT_KEY_SERDE_CLASS_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Serdes<span class=\"token punctuation\">.</span>String</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT_VALUE_SERDE_CLASS_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Serdes<span class=\"token punctuation\">.</span>String</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n        <span class=\"token class-name\">StreamsBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StreamsBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">KStream</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> streamLog <span class=\"token operator\">=</span> builder<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token constant\">STREAM_LOG</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n\t\tstreamLog<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> value<span class=\"token punctuation\">.</span><span class=\"token function\">length</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">to</span><span class=\"token punctuation\">(</span><span class=\"token constant\">STREAM_LOG_FILTER</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> \n  \n        <span class=\"token class-name\">KafkaStreams</span> streams<span class=\"token punctuation\">;</span>  \n        streams <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KafkaStreams</span><span class=\"token punctuation\">(</span>builder<span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        streams<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n</br>\n<ul>\n<li><code class=\"language-text\">stream()</code>: 파라미터로 들어온 토픽의 데이터를 KSteram 구조체로 가져오기 위한 소스 프로세서.</li>\n<li><code class=\"language-text\">filter()</code>: 파라미터로 들어온 필터링 메서드를 사용하여 특정 메시지 값을 필터링하기 위해 사용.</li>\n<li><code class=\"language-text\">to()</code>: 특정 토픽으로 DSL을 적용한 레코드를 저장한다.</li>\n</ul>\n<h2 id=\"8-4-2-ktable과-kstrem을-join\" style=\"position:relative;\"><a href=\"#8-4-2-ktable%EA%B3%BC-kstrem%EC%9D%84-join\" aria-label=\"8 4 2 ktable과 kstrem을 join permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8-4-2) KTable과 KStrem을 join()</h2>\n<div align=\"left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 414px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 88.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABYlAAAWJQFJUiTwAAACh0lEQVR42n2U20tqURDG938f2IvWi1peMrMolKBIu5E+iPikiRJieSkR81ZqmqU1h9/A2mincwZmr73Wmpk18823lvX19SWLxeIvnc/n8v7+rv/I9/e3fH5+ysfHh8xmM3sdYQ0llsXnNxmNRjIcDqVarUoikZBUKiUvLy/y9vYm0+lUKpWKnJ2dSTqdltfXV90jCYvInU5Her2ePD8/63+73ZZut6tr4XBYQqGQbG9vy+npqR7G/s7OjqrX65XLy0sZj8dagUUAHGKxmOzu7orb7VajZDIppVJJ1tfXxeFwyMbGhmxubmo2+XxenE6nrK2t2faPj48KizWZTOT+/l7q9bpqrVaTh4cHaTabqhgHAgFV/smi0WjI1taWnXkwGJTBYKC4/hdDwM/lchKJRDQjMsYepUyCUhUJYA981nKXOR1gUYKBCw3A8O7uThuDUN7NzY3uo9hSqd1lo78JuCAcdnx8LOfn57K/v684Ivhhg67QBorc3t5KoVCQYrGopaLgioAtWPl8PsUtGo0qT3/y2DIEfXp6Ugf06OhI9vb21Dkej6tjJpMRj8cjLpfLblCr1dKAlGwIb5mUmcC9fr+vPIOTODBHmMM7Okuwg4MDxRco8EWVh//CcBkXqmDkAAKdnJzozWDfNNEu2WTIaDaMkZmbshCCgSfCNSSr5aQsDMGI0SyaIIxggxPlXV9fa4fJslwu2w+IKVkxZAEHMLq6utIrB8cuLi5U6Tw2dJym0BAaB57cDg6EgxyoAU2XudNQga7yivAP77LZrAZkNJSBAdxhMCVL05wVYi+nz8jJZg7GXK3Dw0Px+/36SPDyGL9lrFe6bDr7U00VXDNKh/hkZJq5rH8AfM4bvKXhJ/AAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"kafka streams join\" title=\"\" src=\"/static/b112ef04b063f8aedcaaea9b6ad65496/b910a/kafka_streams_join.png\" srcset=\"/static/b112ef04b063f8aedcaaea9b6ad65496/5a46d/kafka_streams_join.png 300w,\n/static/b112ef04b063f8aedcaaea9b6ad65496/b910a/kafka_streams_join.png 414w\" sizes=\"(max-width: 414px) 100vw, 414px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n</div>\n<br>\n<ul>\n<li>KTable과 KStream은 메시지 키를 기준으로 조인할 수 있다. 대부분의 데이터베이스는 정적으로 저장된 데이터를 조인하여 사용했지만 카프카에서는 실시간으로 들어오는 데이터를 조인할 수 있다. 사용자의 이벤트 데이터를 데이터베이스에 저장하지 않고도 조인하여 처리할 수 있다는 장점이 있다. 이를 통해 이벤트 기반 스트리밍 데이터 파이프라인을 구성할 수 있다.</li>\n<li>키를 기준으로 값을 join하여 처리할 수 있다.</li>\n</ul>\n</br>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>example</span><span class=\"token punctuation\">;</span>  \n  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>common<span class=\"token punctuation\">.</span>serialization<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Serdes</span></span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>streams<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">KafkaStreams</span></span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>streams<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamsBuilder</span></span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>streams<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">StreamsConfig</span></span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>streams<span class=\"token punctuation\">.</span>kstream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">KStream</span></span><span class=\"token punctuation\">;</span>  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>kafka<span class=\"token punctuation\">.</span>streams<span class=\"token punctuation\">.</span>kstream<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">KTable</span></span><span class=\"token punctuation\">;</span>  \n  \n<span class=\"token keyword\">import</span> <span class=\"token import\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>util<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Properties</span></span><span class=\"token punctuation\">;</span>  \n  \n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KStreamJoinKTable</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">APPLICATION_NAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"order-join-application\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">BOOTSTRAP_SERVERS</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"my-kafka:19092\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">ADDRESS_TABLE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"address\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">ORDER_STREAM</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"order\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">ORDER_JOIN_STREAM</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"order_join\"</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n  \n        <span class=\"token class-name\">Properties</span> props <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Properties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_ID_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">APPLICATION_NAME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BOOTSTRAP_SERVERS_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">BOOTSTRAP_SERVERS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT_KEY_SERDE_CLASS_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Serdes<span class=\"token punctuation\">.</span>String</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT_VALUE_SERDE_CLASS_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Serdes<span class=\"token punctuation\">.</span>String</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n        <span class=\"token class-name\">StreamsBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StreamsBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">KTable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> addressTable <span class=\"token operator\">=</span> builder<span class=\"token punctuation\">.</span><span class=\"token function\">table</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ADDRESS_TABLE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">KStream</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> orderStream <span class=\"token operator\">=</span> builder<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ORDER_STREAM</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n        orderStream<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>addressTable<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>order<span class=\"token punctuation\">,</span> address<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> order <span class=\"token operator\">+</span> <span class=\"token string\">\" send to \"</span> <span class=\"token operator\">+</span> address<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">to</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ORDER_JOIN_STREAM</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n        <span class=\"token class-name\">KafkaStreams</span> streams<span class=\"token punctuation\">;</span>  \n        streams <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KafkaStreams</span><span class=\"token punctuation\">(</span>builder<span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        streams<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n</br>\n<ul>\n<li><code class=\"language-text\">table()</code>: 파라미터로 들어온 토픽의 데이터를 KTable 구조체로 가져오기 위한 소스 프로세서.</li>\n<li><code class=\"language-text\">join(Join될 대상 테이블, 메시지 값)</code>: 테이블을 Join하여 생성할 메시지 값을 지정.</li>\n</ul>\n</br>\n<h2 id=\"8-4-3-kstream과-globalktable을-join\" style=\"position:relative;\"><a href=\"#8-4-3-kstream%EA%B3%BC-globalktable%EC%9D%84-join\" aria-label=\"8 4 3 kstream과 globalktable을 join permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8-4-3) KStream과 GlobalKTable을 join()</h2>\n<ul>\n<li>코파티셔닝되지 않은 토픽 간에 join()을 수행하기 위해서는 리파티셔닝(파티션 개수를 재지정)하거나 GlobalKTable로 선언하여 사용하는 방법이 있다.</li>\n</ul>\n</br>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">KStreamJoinGlobalKTable</span> <span class=\"token punctuation\">{</span>  \n  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">APPLICATION_NAME</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"global-table-join-application\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">BOOTSTRAP_SERVERS</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"my-kafka:19092\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">ADDRESS_GLOBAL_TABLE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"address_v2\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">ORDER_STREAM</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"order\"</span><span class=\"token punctuation\">;</span>  \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">static</span> <span class=\"token class-name\">String</span> <span class=\"token constant\">ORDER_JOIN_STREAM</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"order_join\"</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> args<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>  \n  \n        <span class=\"token class-name\">Properties</span> props <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Properties</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">APPLICATION_ID_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">APPLICATION_NAME</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BOOTSTRAP_SERVERS_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">BOOTSTRAP_SERVERS</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT_KEY_SERDE_CLASS_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Serdes<span class=\"token punctuation\">.</span>String</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        props<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">StreamsConfig</span><span class=\"token punctuation\">.</span><span class=\"token constant\">DEFAULT_VALUE_SERDE_CLASS_CONFIG</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Serdes<span class=\"token punctuation\">.</span>String</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getClass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n        <span class=\"token class-name\">StreamsBuilder</span> builder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">StreamsBuilder</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">GlobalKTable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> addressGlobalTable <span class=\"token operator\">=</span> builder<span class=\"token punctuation\">.</span><span class=\"token function\">globalTable</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ADDRESS_GLOBAL_TABLE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        <span class=\"token class-name\">KStream</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span><span class=\"token punctuation\">></span></span> orderStream <span class=\"token operator\">=</span> builder<span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ORDER_STREAM</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n        orderStream<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>addressGlobalTable<span class=\"token punctuation\">,</span>  \n                        <span class=\"token punctuation\">(</span>orderKey<span class=\"token punctuation\">,</span> orderValue<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> orderKey<span class=\"token punctuation\">,</span>  \n                        <span class=\"token punctuation\">(</span>order<span class=\"token punctuation\">,</span> address<span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> order <span class=\"token operator\">+</span> <span class=\"token string\">\" send to \"</span> <span class=\"token operator\">+</span> address<span class=\"token punctuation\">)</span>  \n                <span class=\"token punctuation\">.</span><span class=\"token keyword\">to</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ORDER_JOIN_STREAM</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n        <span class=\"token class-name\">KafkaStreams</span> streams<span class=\"token punctuation\">;</span>  \n        streams <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">KafkaStreams</span><span class=\"token punctuation\">(</span>builder<span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        streams<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n  \n    <span class=\"token punctuation\">}</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n</br>\n<ul>\n<li><code class=\"language-text\">globalTable(Join될 대상 테이블, 원래 테이블에서 Join의 키로 사용할 값, 메시지 값)</code>: 파라미터로 들어온 토픽의 데이터를 GlobalKTable 구조체로 가져오기 위한 소스 프로세서.</li>\n</ul>","frontmatter":{"title":"8-4) 스트림즈 애플리케이션 개발하기","date":"January 27, 2025"}}},"pageContext":{"slug":"/kafka/kafka_8_4/","previous":{"fields":{"slug":"/kafka/kafka_8_3/"},"frontmatter":{"title":"8-3) 스트림즈DSL 중요 옵션(필수 옵션)"}},"next":{"fields":{"slug":"/kafka/kafka_8_5/"},"frontmatter":{"title":"8-5) 스트림즈 DSL의 윈도우 프로세싱"}}}},"staticQueryHashes":["3128451518","643154061"],"slicesMap":{}}