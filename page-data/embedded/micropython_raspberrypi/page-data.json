{"componentChunkName":"component---src-templates-blog-post-js","path":"/embedded/micropython_raspberrypi/","result":{"data":{"site":{"siteMetadata":{"title":"Devlog"}},"markdownRemark":{"id":"a7565ee3-21d8-55e3-a4e6-8e688c7cd126","excerpt":"RaspberryPi Pico는 라이베리파이 재단에서 소형 MCU 보드로, 기존 라즈베리파이가 MPU를 사용하여 OS를 올리는 방식과 달리 마이크로컨트롤러를 이용하였다. 또한, 자체 설계한 RP204…","html":"<p>RaspberryPi Pico는 라이베리파이 재단에서 소형 MCU 보드로, 기존 라즈베리파이가 MPU를 사용하여 OS를 올리는 방식과 달리 마이크로컨트롤러를 이용하였다. 또한, 자체 설계한 RP2040 프로세서로 작지만 강력한 성능을 보여주는 장치이다. 내가 프로젝트를 하면서 이 녀석을 사용하게 된 이유는 가성비가 엄청나다는 점이었다. 단순하게 가격 비교만 해봐도 아래와 같이 비교가 된다.</p>\n<div align=\"center\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/cb596737907dd45c40f3992288ffdb26/8de58/raspberrypi4.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 51.26582278481012%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACOElEQVR42lVSS2sTURTO7xEFwYqLiGIJ2ICID4IiQmPFRyvUhaJF1E1XQlaK0YXFXbtyI4iodVmMaW1jSKSJ0zbJNJN55zGPzEwm+Tz3hoZ44HBf53z3+845EVmRIUr70HQNdUlCo9GAruswDAOqpkHTVL5vWRaMponBYDByZkEQ0LvJV3YXURsylJ0arI6FTqcDmxJ1WYUmK2hSoKYbqIt16MIOxGoVlZYJx3Vg2zbcbheu68I0TViU16VzxNsTsZV6h+21DQiZTezlipBLJUiCgHZdQUC/7ldEeMIu5EoFv+sSZ9Pv9/9jGoYhv49sSTlcnruE6LUpHE+exdHrMcRmJvF17Rt8L6DAHlqtJuzAR59Y0QGe53HAcWNnDpjdzSP+aBq3Fu9h5kESRxKTOJQ4jSfPnyJfKKBHgBrVMuz10CUgm2QNOQ1GYONMI9ulPzj37AauvpjH+YfTiCYv4DABJh/PIrOeQ0BSHMeG7we8Rg6xZAx93+c+2tPKGf4sZnEsPoETC1cwkbqN+J0EohdP4ebCXayufudSWMKwmzpEsQZFUfg0SDQVqqpy0OBAsmlJWFpJI/X+Jd6svMXr9Cuk0otY/riMcvkvl3IA2CPZzBmA5w1ZhWx0WMdpAlhZIuN1YNakH4sfPsP4lEH9yw8MeiEHZHJZJ8djubHRkRpo0udhuzMEZLI2cusQqgJqtSp+bWZRLuQRmhZ/cxyHDzufU2LD3KBGuZTbmp1H+2QM7TNTsObu4x8FXsVHXFyBagAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"raspberrypi4\" title=\"\" src=\"/static/cb596737907dd45c40f3992288ffdb26/f058b/raspberrypi4.png\" srcset=\"/static/cb596737907dd45c40f3992288ffdb26/c26ae/raspberrypi4.png 158w,\n/static/cb596737907dd45c40f3992288ffdb26/6bdcf/raspberrypi4.png 315w,\n/static/cb596737907dd45c40f3992288ffdb26/f058b/raspberrypi4.png 630w,\n/static/cb596737907dd45c40f3992288ffdb26/40601/raspberrypi4.png 945w,\n/static/cb596737907dd45c40f3992288ffdb26/8de58/raspberrypi4.png 1219w\" sizes=\"(max-width: 630px) 100vw, 630px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/e161958e295b61493e913443848b899b/9239a/picowh.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.53164556962025%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACHElEQVR42l1TS2sUQRCeH+RZ/AGevHgR9RLwJIiClxA8iIInHxdFyUXEQyKCkT1orsHEBfEQhQ0uya5kJ3FfM5vdefS8ex6fVbU7sNozNT1d0/XVV1/1GEedDgaDAcwTE6Zpot//g5PTU/R6PYyGQ1hk47GNNMuQZSlZJqa1RlmWsG0bruuKr6oqGEmSIIoixHGMkOYwDGXN/jRNceBMMR12kQcu4ryEXgDWoLwnpUS8v6xKGIzKmYqiACq+5xcP9h8TA8+xkHMSP0Ke5+LnODaJoJmBhWFOQPMPwEwnePdzBx/2GogjT3zK8+ATa01Wnp1JoCT/b3AiAeSFl8ZotL/h2tM1XHl8B+dXr+Ph5hNikmPmOFIeJ1ZRLOxkLEjUTGtSxla7ifub69j4+Aa3XtzDubUVPNp4hcNuRzawpgzIGgVKycxrZio6L2nKyYzb289x4fUqVl4+wN23z7B/8ANlpufZ6WLhtc7hKx/9wRCTyQSWZVHnLdj0zo2sEwggB75vNrC18xkZfZRmcKO4DNJFE0hBzLTnIyM9E18hpjlmXxCgYG0priCrGFD6xLosNFjWhX2aykooqCAWy3vqwe0JxyNkdBZFw2rBaDSjUhwymmuB+VmfNU1subti/M5gVHqy+xX+lz2Eu01UKpiXnNDB/N5tYf+ohdbv9j9MGYw7rajE+gdwp1PEzOzTNtTFSwhv3IS6fBX5rzb+AlLyObta6QHsAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"picowh\" title=\"\" src=\"/static/e161958e295b61493e913443848b899b/f058b/picowh.png\" srcset=\"/static/e161958e295b61493e913443848b899b/c26ae/picowh.png 158w,\n/static/e161958e295b61493e913443848b899b/6bdcf/picowh.png 315w,\n/static/e161958e295b61493e913443848b899b/f058b/picowh.png 630w,\n/static/e161958e295b61493e913443848b899b/40601/picowh.png 945w,\n/static/e161958e295b61493e913443848b899b/9239a/picowh.png 1246w\" sizes=\"(max-width: 630px) 100vw, 630px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n</div>\n</br>\n<p>위 사진은 본체 단위의 단순 가격을 비교한건데, 본체만 했을 때 거의 1/8 가격으로 구매 가능하다. Pico WH의 경우 헤더핀을 장착한 모델인데, 헤더핀을 빼고 구매하면 더 저렴하게 구매 가능하다. 불과 수 년 전만 해도 라즈베리파이가 이정도 가격은 아니였던 때도 있었는데, 코로나 시기 반도체 물량 부족으로 인해 가격이 천정부지로 올라버렸다.</p>\n</br>\n<p>물론, 기존 Raspberry Pi 4가 성능적으로도 더 우월하며, OS가 올라가 있어 각종 설정이 쉽다. 또한, 레퍼런스가 많아 다양한 작업을 빠르게 찾아 적용 가능하다는 점에서 구현 면에서는 훨씬 쉬울 것이다. 하지만, OS에서 제공하는 대부분의 기능은 내가 원하는 프로젝트에서는 너무 무겁게 느껴지게 되었고 Pico의 경우 아두이노보다도 더 저렴한 MCU다 보니 선택하게 되었다.</p>\n</br>\n<p>Pico는 아래와 같은 Pinout을 갖는다. I2C, SPI, UART 2개, 12 Bit ADC 3개, 16채널 PWM을 제공하며 USB 1.1 포트를 제공한다. USB 1.1 포트를 통해서 전원을 공급하거나 각종 파일 전달이 가능하다. Pico W의 경우 각종 무선 네트워크 기능이 추가로 제공된다. 지원되는 인터페이스로는 단일 밴드 2.4GHz 무선 인터페이스 (Wi-fi), WPA3, Blooth 5.2 (Blooth Classic, BLE 모두 지원)가 있다.</p>\n<div align=\"center\">\n  <img src=\"./images/pico-pinout.svg\" width=\"600px\">\n</div>\n</br>\n<p>Pico는 기본적으로 C, C++ 기반의 임베디드 언어를 지원한다. 다만, 이를 위해서는 <a href=\"https://github.com/raspberrypi/pico-sdk\">pico SDK</a>를 사용하거나 <a href=\"https://www.freertos.org/index.html\">RTOS</a>와 같은 오픈소스 프로젝트를 공부해야 한다는 점에서 빠른 기능 구현을 위해 포기하게 되었다.</p>\n</br>\n<p>C나 C++을 제외한다면 가장 대중적으로 사용되는 언어는 <a href=\"https://micropython.org/\">MicroPython</a>이다. 라즈베리파이 재단에서 공식적으로 지원하는 언어는 이렇게 두 종류이다. 파이썬이라면 학부때 사용했던 기억이 있기에 이를 채택하게 되었다. 레퍼런스도 pico SDK 다음으로 많았기 때문에 대부분의 기능을 쉽게 구현 가능했다. (물론 성능을 고려한다면 C/C++를 사용하는게 좋다.)</p>\n</br>\n<p>앞서 너무 많은 TMI를 서술하였는데, 제목의 내용을 간단하게 설명해보고자 한다. C++/C 코드를 구현하는 방법은 차후에 다시 작성할 예정이다.</p>\n</br>\n<h2>1. MicroPhton SDK 다운로드</h2>\n<p>먼저, SDK의 경우 <a href=\"https://www.raspberrypi.com/documentation/microcontrollers/micropython.html#what-is-micropython\">링크</a>에서 다운로드 가능하다. 페이지에 접속하여, 화면을 좀 내리다 보면 아래와 같은 부분을 발견할 수 있다.</p>\n</br>\n<div align=\"center\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/bd76d053e746e1534eb720649b760ef9/146da/micropython_install.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 77.21518987341771%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB50lEQVR42pVU227aQBD1p6bqBySNeEBB6ieA+gEtIuQHmuf0rbxWFUUlQCUQaYBdX9b2mgU7mJOZRW6tCid0pePZi+fs2dmZdcTDI370+7j/OcR4PMZoNMJwOMRkMsFgMMB0OsV2u8Vms3kVxhg4sdYQyyXcpYDv+wj8AEEQHPolW0ApRVZZG4ahhZ0jrNdrODrR8KIQYiUgpYTruhZC0tiVFq7nIY41oigiG/+xLCaOaBwfxpbQ6AR6NMVTlsGQbN4gJgdeLCNJEmvZMaN/0zQ9fmRDO6jedyDfI9ExElKy3+9R1fI8t+tMyBswSRkOB5xbSru+v2rg7dkbnF+co9FooNlsotVqoV6v493lJc1foFar2ZAwKauuJMzSDJ9vb9HtdnHd6aBDuPtyh6+9HtrtNj4QcfvjJ9zcdG0Md7vdywq58Y1xfBgcE3ZkFch2wFP+f0fmNpvNIISwR5rP53hcLLB4+I1f3/qUWiusaE1RyjDpq4S8K98gK9KcDtS3uacIpJznirWTCYsg/5sKpuTIJBy/SsJyjhX9QkkxX1Vmx+Cwo0sV4kv3ACq1Q3n9LbdjSioJzcZAU6C19JB4AXQYQRH4xllJ8TCcTLimT0yKtOtD08OgSKGkW5aCHwsPfuDb9DmV8BnRtGsAa2xTywAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"micropython install\" title=\"\" src=\"/static/bd76d053e746e1534eb720649b760ef9/f058b/micropython_install.png\" srcset=\"/static/bd76d053e746e1534eb720649b760ef9/c26ae/micropython_install.png 158w,\n/static/bd76d053e746e1534eb720649b760ef9/6bdcf/micropython_install.png 315w,\n/static/bd76d053e746e1534eb720649b760ef9/f058b/micropython_install.png 630w,\n/static/bd76d053e746e1534eb720649b760ef9/146da/micropython_install.png 943w\" sizes=\"(max-width: 630px) 100vw, 630px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n</div>\n</br>\n<p>각 링크는 라즈베리파이 피코, 라즈베리파이 피코 W (BLE 기능 제외 Wi-fi만 제공), 라즈베리파이 피코 W (BLE 기능 추가 지원)으로, 사용하고자 하는 라즈베리파이 버전과 용도에 맞게 다운로드를 하면 된다. 다운로드를 하면 <code class=\"language-text\">.uf2</code> 파일이 받아진다.</p>\n</br>\n<h2>2. Raspberry Pi Pico 연결</h2>\n<p>Pico를 연결하면 Windows의 경우 자동으로 드라이버를 설치해준다. Mac이나 Linux의 경우 COM Port를 붙어서 진행하거나 <a href=\"https://thonny.org/\">Thonny IDE</a>를 통해서도 설치 가능하다. 처음 연결하면 바로 가능하나, 다시 SDK를 설치하고자 하면 pico의 <code class=\"language-text\">BOOTSET</code> 버튼을 꾹 누르면 SDK가 초기화되어 설치 가능하다.</p>\n</br>\n<h2>3. SDK 설치</h2>\n<p>라즈베리파이가 연결되었고 내PC에서 연결된 것이 보이면 아까 다운받았던 <code class=\"language-text\">uf2</code> 파일을 넣어주면 끝이다. Thonny IDE로 다운받을 경우 pico를 연결한 뒤, 화면 우측 하단에서 <code class=\"language-text\">Install MicroPython</code>을 통해 설치 가능하다. 다만, 이 경로로 설치를 하면 pico W의 경우, BLE 기능이 지원되는 SDK를 설치할 수 없다는 단점이 있다.</p>\n</br>\n<p>코드 작성은 Visual Studio Code나 Thonny IDE를 통해서 가능하다. IDE로서의 기능은 VS Code가 좋지만, pico에 파일을 전달하거나 하는 UI는 Thonny가 더 낫다. 취향대로 사용하면 된다. 두 IDE 모두 pico 내부 혹은 PC의 <code class=\"language-text\">.py</code> 파일을 동작하도록 하는 것도 가능하다. 외부 전원을 넣고 전원이 들어올때마다 자동으로 동작시키고자 한다면 <code class=\"language-text\">main.py</code> 파일 내에 main 함수를 작성해주면 된다.</p>\n</br>\n<h2>4. 초기화</h2>\n<p>만약, <code class=\"language-text\">main.py</code> 파일을 작성하여 동작시키도록 하였는데, 반복 루프를 걸어서 PC에 연결을 해도 동작이 멈추지 않는다면 어떻게 해야할까? 보통은 인터럽트를 걸어서 코드를 중단시키는 방법이 있으나 통하지 않는 경우도 있다. 이 경우 SDK 재설치 방법은 통하지 않는다. SDK 재설치는 SDK 파일만 날리는 거라 <code class=\"language-text\">.py</code> 파일들은 그대로 남아 있어 설치한 뒤에 바로 또 빠져나올 수 없는 루프로 진입하게 된다.</p>\n<p>이때는 <a href=\"https://github.com/dwelch67/raspberrypi-pico/blob/main/flash_nuke.uf2\">flash_nuke.uf2</a> 파일을 넣어주면 된다. SDK 초기화와 마찬가지로 <code class=\"language-text\">BOOTSET</code> 버튼을 누른 뒤, 화면을 통해 flash_nuke.uf2 파일을 넣어주기만 하면 된다.</p>\n</br>\n<h2>끝마치며</h2>\n<p>위 내용들은 사실 <a href=\"https://www.raspberrypi.com/documentation/microcontrollers/raspberry-pi-pico.html\">메뉴얼</a>만 천천히 읽어봐도 쉽게 확인 가능한 내용들이다. 나처럼 삽질하면서 하나씩 알아가는 사람이 없기를 바라며 이렇게 정리해보았다.</p>\n</br>\n<p>추가로, 지원되는 언어를 찾아보다 보니 Go언어에서도 이러한 임베디드 프로그래밍을 지원하기 위한 프로젝트가 있는 모양이다. <a href=\"https://tinygo.org/\">TinyGo</a>라고 하는데, 예시 코드가 돌아가는 MCU가 Raspberry Pi를 이용한 것 같다. 라이브러리를 대충 보니 공식 지원되는 언어와 비슷한 기능들이 대부분 지원되는 것 같아서 한번 고려해 보는 것도 좋을 것 같다. 빌드 후 바이너리의 형태를 pico에 넣는 방식인 것을 보니 MicroPython 보다는 성능적으로 더 좋지 않을까 싶다.</p>","frontmatter":{"title":"[MicroPython] RaspberryPi Pico에서 MicroPython 사용하기","date":"August 14, 2023","description":null}},"previous":{"fields":{"slug":"/web/jwt&paesto/"},"frontmatter":{"title":"[Web] JWT Token과 PASETO"}},"next":{"fields":{"slug":"/web/jwt&paesto/"},"frontmatter":{"title":"[Web] JWT Token과 PASETO"}}},"pageContext":{"id":"a7565ee3-21d8-55e3-a4e6-8e688c7cd126"}},"staticQueryHashes":["230163734","3589320610"],"slicesMap":{}}