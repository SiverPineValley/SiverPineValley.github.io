{"componentChunkName":"component---src-templates-blog-post-js","path":"/golang/package/","result":{"data":{"site":{"siteMetadata":{"title":"Devlog"}},"markdownRemark":{"id":"d65fb7ad-6ba8-5a0b-8db7-e21853659f67","excerpt":"1. 운영체제에 종족적인 코드 처리 운영체제에 따라 코드가 다를 경우 다음과 같은 방식으로 처리할 수 있다. ₩runtime.GOOS`로 운영체제를 확인한 후 분기 처리. 해당 상수는 runtime…","html":"<h2>1. 운영체제에 종족적인 코드 처리</h2>\n<p>운영체제에 따라 코드가 다를 경우 다음과 같은 방식으로 처리할 수 있다.</p>\n<ol>\n<li>\n<p>₩runtime.GOOS`로 운영체제를 확인한 후 분기 처리. 해당 상수는 runtime 패키지에 정의되어 있는 상수이고, 운영체제를 확인할 때 사용한다. 운영체제에 따라 darwin, freebsd, linux, windows를 반환하며 이 값으로 분기 처리를 한다.</p>\n</li>\n<li>\n<p>운영체제별로 .go 파일을 분리</p>\n</li>\n</ol>\n<p>패키지 안에 main.go, util_linux.go, util_windows.go 파일이 있을 때 리눅스로 빌드하면 util_windows.go 파일은 무시된다. 반대의 케이스도 마찬가지로 적용된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">package</span> main\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">showOS</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">package</span> main\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"fmt\"</span>\n    <span class=\"token string\">\"runtime\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">showOS</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"현재 파일: util_darwin.go\"</span><span class=\"token punctuation\">)</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>runtime<span class=\"token punctuation\">.</span>GOOS<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">package</span> main\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"fmt\"</span>\n    <span class=\"token string\">\"runtime\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">showOS</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"현재 파일: util_linux.go\"</span><span class=\"token punctuation\">)</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>runtime<span class=\"token punctuation\">.</span>GOOS<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>2. Refelction</h2>\n<p>reflect 패키지를 사용하면 프로그램의 메타 데이터를 활용하여 객체를 동적으로 제어할 수 있다. 즉, 런타임 시 타입이 정해지지 않은 값의 실제 타입을 확인하여 그 값의 메서드를 호출하거나 내부 필드에 접근할 수 있다.</p>\n<h3>2.1 타입/값 정보 확인</h3>\n<p>reflect 패키지를 이용해서 값의 타입과 실제 값을 확인할 수 있다. reflect.TypeOf(), reflect.ValueOf()가 그것이다. ValueOf() 함수에는 Bool(), Complex(), String(), Int() 와 같이 실제 값을 확인하는 메서드가 있다.</p>\n<p>슬라이스와 맵 같은 컬렉션 타입이나 구조체도 리플렉션으로 메타 정보를 확인할 수 있다. 구조체의 태그 정보에 접근할 때도 리플렉션을 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">type</span> User <span class=\"token keyword\">struct</span><span class=\"token punctuation\">{</span>\n    Name <span class=\"token builtin\">string</span> <span class=\"token string\">\"check:len(3,40)\"</span>\n    Id <span class=\"token builtin\">int</span> <span class=\"token string\">\"check:range(1,999999)\"</span>\n<span class=\"token punctuation\">}</span>\n\nu <span class=\"token operator\">:=</span> User<span class=\"token punctuation\">{</span><span class=\"token string\">\"Jang\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span>\nuType <span class=\"token operator\">:=</span> reflect<span class=\"token punctuation\">.</span><span class=\"token function\">TypeOf</span><span class=\"token punctuation\">(</span>u<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> fName<span class=\"token punctuation\">,</span> ok <span class=\"token operator\">:=</span> uType<span class=\"token punctuation\">.</span><span class=\"token function\">FieldByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Name\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ok <span class=\"token punctuation\">{</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>fName<span class=\"token punctuation\">.</span>Type<span class=\"token punctuation\">,</span> fName<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">,</span> fName<span class=\"token punctuation\">.</span>Tag<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">if</span> fId<span class=\"token punctuation\">,</span> ok <span class=\"token operator\">:=</span> uType<span class=\"token punctuation\">.</span><span class=\"token function\">FieldByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> ok <span class=\"token punctuation\">{</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>fId<span class=\"token punctuation\">.</span>Type<span class=\"token punctuation\">,</span> fId<span class=\"token punctuation\">.</span>Name<span class=\"token punctuation\">,</span> fId<span class=\"token punctuation\">.</span>Tag<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>2.2 값 변경</h3>\n<p>reflect.Value 내부의 실제 값이 변경할 수 있는 값이라면 그 값을 동적으로 변경할 수 있다. 변경 가능한 값인지는 reflect.Value.CanSet() 메서드로 확인한다. int, float64, string처럼 변경할 수 없는 값은 그 값을 SetXXX 메서드로 변경할 수 없다. 하지만 Elem() 메서드를 사용하여 주소에 접근하는 방법을 통해 다른 값으로 교체할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\">x <span class=\"token operator\">:=</span> <span class=\"token number\">1</span>\n<span class=\"token keyword\">if</span> v <span class=\"token operator\">:=</span> refelct<span class=\"token punctuation\">.</span><span class=\"token function\">ValueOf</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> v<span class=\"token punctuation\">.</span><span class=\"token function\">CanSet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    v<span class=\"token punctuation\">.</span><span class=\"token function\">SetInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 호출되지 않음</span>\n<span class=\"token punctuation\">}</span>\n\nfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 1</span>\n\nv <span class=\"token operator\">:=</span> reflect<span class=\"token punctuation\">.</span><span class=\"token function\">ValueOf</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>x<span class=\"token punctuation\">)</span>\np <span class=\"token operator\">:=</span> v<span class=\"token punctuation\">.</span><span class=\"token function\">Elem</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span><span class=\"token function\">SetInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\nfmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token comment\">// 3</span></code></pre></div>\n<h3>2.3 함수/메서드 동적 호출</h3>\n<p>리플렉션을 사용하면 동적으로 함수나 메서드를 호출할 수 있다. 다음 예제는 TitleCase() 함수를 두 번 호출하여 결과값을 출력하는데, 첫 번째 함수를 바로 호출하고 두 번째는 리플렉션을 사용한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">TitleCase</span><span class=\"token punctuation\">(</span>s <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> strings<span class=\"token punctuation\">.</span><span class=\"token function\">Title</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    caption <span class=\"token operator\">:=</span> <span class=\"token string\">\"go is an open source programming language\"</span>\n\n    <span class=\"token comment\">// TitleCase를 바로 호출</span>\n    title <span class=\"token operator\">:=</span> <span class=\"token function\">TitleCase</span><span class=\"token punctuation\">(</span>caption<span class=\"token punctuation\">)</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// TitleCase를 동적으로 호출</span>\n    titleFuncValue <span class=\"token operator\">:=</span> reflect<span class=\"token punctuation\">.</span><span class=\"token function\">ValueOf</span><span class=\"token punctuation\">(</span>TitleCase<span class=\"token punctuation\">)</span>\n    values <span class=\"token operator\">:=</span> titleFuncValue<span class=\"token punctuation\">.</span><span class=\"token function\">Call</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>reflect<span class=\"token punctuation\">.</span>Value<span class=\"token punctuation\">{</span>reflect<span class=\"token punctuation\">.</span><span class=\"token function\">ValueOf</span><span class=\"token punctuation\">(</span>caption<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    title <span class=\"token operator\">=</span> values<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">String</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>x <span class=\"token keyword\">interface</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token builtin\">int</span> <span class=\"token punctuation\">{</span>\n    value <span class=\"token operator\">:=</span> reflect<span class=\"token punctuation\">.</span><span class=\"token function\">ValueOf</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">switch</span> refelct<span class=\"token punctuation\">.</span><span class=\"token function\">TypeOf</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Kind</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">case</span> reflect<span class=\"token punctuation\">.</span>Array<span class=\"token punctuation\">,</span> reflect<span class=\"token punctuation\">.</span>Chan<span class=\"token punctuation\">,</span> reflect<span class=\"token punctuation\">.</span>Map<span class=\"token punctuation\">,</span> reflect<span class=\"token punctuation\">.</span>Slice<span class=\"token punctuation\">,</span> reflect<span class=\"token punctuation\">.</span>String<span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> Value<span class=\"token punctuation\">.</span><span class=\"token function\">Len</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> method <span class=\"token operator\">:=</span> value<span class=\"token punctuation\">.</span><span class=\"token function\">MethodByName</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Len\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> method<span class=\"token punctuation\">.</span><span class=\"token function\">IsValid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                values <span class=\"token operator\">:=</span> method<span class=\"token punctuation\">.</span><span class=\"token function\">Call</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">nil</span><span class=\"token punctuation\">)</span>\n                <span class=\"token keyword\">return</span> <span class=\"token function\">int</span><span class=\"token punctuation\">(</span>Values<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">Int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token function\">panic</span><span class=\"token punctuation\">(</span>fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Sprintf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"'%v' does not hiave a length\"</span><span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    a <span class=\"token operator\">:=</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">New</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    b <span class=\"token operator\">:=</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">New</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    b<span class=\"token punctuation\">.</span><span class=\"token function\">PushFront</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n    c <span class=\"token operator\">:=</span> <span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"B\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">}</span>\n    d <span class=\"token operator\">:=</span> <span class=\"token string\">\"one\"</span>\n    e <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">{</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span>\n\n    fmt<span class=\"token punctuation\">.</span><span class=\"token function\">Println</span><span class=\"token punctuation\">(</span><span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>d<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>3. Test</h2>\n<p>Go는 기본 라이브러리로 제공되는 testing 패키지로 유닛 테스트를 할 수 있다.\n<code class=\"language-text\">go test</code> 명령어를 실행하면 패키지 디렉터리에 있는 테스트 파일에서 테스트 함수를 찾아 테스트를 수행한다.</p>\n<ul>\n<li>테스트 파일: 파일 이름이 _test.go로 끝나는 파일</li>\n<li>테스트 함수: 함수 이름이 Test로 시작하고 *testing.T를 매개변수로 받는 함수</li>\n</ul>\n<p>테스트 함수의 성공/실패는 testing.T.Errorf()와 같은 테스트 실패 메서드를 호출하는 것으로 결정된다. 테스트 함수 내에서 testing.T.Errorf()와 같은 테스트 실패 메서드를 호출하면 해당 함수는 FAIL로 처리되고, 테스트 실패 메서드를 호출하지 않으면 SUCCESS로 처리된다. Errorf() 메서드 외에도 testing.T.Fail(), testing.T.Fatal()과 같은 메서드도 있다. 이러한 메서드를 통해 FAIL의 레벨을 제어할 수 있다.</p>\n<p>다음은 앞서 작성한 Len() 함수의 유닛 테스트 파일이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">package</span> main\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"testing\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">TestLenForMap</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">*</span>testing<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    v <span class=\"token operator\">:=</span> <span class=\"token keyword\">map</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"A\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"B\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">}</span>\n    actual<span class=\"token punctuation\">,</span> expected <span class=\"token operator\">:=</span> <span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span>\n    <span class=\"token keyword\">if</span> actual <span class=\"token operator\">!=</span> expected <span class=\"token punctuation\">{</span>\n        t<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d != %d\"</span><span class=\"token punctuation\">,</span> actual<span class=\"token punctuation\">,</span> expected<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">TestLenForString</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">*</span>testing<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    v <span class=\"token operator\">:=</span> <span class=\"token string\">\"one\"</span>\n    actual<span class=\"token punctuation\">,</span> expected <span class=\"token operator\">:=</span> <span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span>\n    <span class=\"token keyword\">if</span> actual <span class=\"token operator\">!=</span> expected <span class=\"token punctuation\">{</span>\n        t<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d != %d\"</span><span class=\"token punctuation\">,</span> actual<span class=\"token punctuation\">,</span> expected<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">TestLenForSlice</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">*</span>testing<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    v <span class=\"token operator\">:=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">int</span><span class=\"token punctuation\">{</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span>\n    actual<span class=\"token punctuation\">,</span> expected <span class=\"token operator\">:=</span> <span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span>\n    <span class=\"token keyword\">if</span> actual <span class=\"token operator\">!=</span> expected <span class=\"token punctuation\">{</span>\n        t<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d != %d\"</span><span class=\"token punctuation\">,</span> actual<span class=\"token punctuation\">,</span> expected<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">func</span> <span class=\"token function\">TestLenForChan</span><span class=\"token punctuation\">(</span>t <span class=\"token operator\">*</span>testing<span class=\"token punctuation\">.</span>T<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    v <span class=\"token operator\">:=</span> <span class=\"token function\">make</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">chan</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">)</span>\n    actual<span class=\"token punctuation\">,</span> expected <span class=\"token operator\">:=</span> <span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span>\n    <span class=\"token keyword\">if</span> actual <span class=\"token operator\">!=</span> expected <span class=\"token punctuation\">{</span>\n        t<span class=\"token punctuation\">.</span><span class=\"token function\">Errorf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d != %d\"</span><span class=\"token punctuation\">,</span> actual<span class=\"token punctuation\">,</span> expected<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>go test로 돌려보면 위 세개는 PASS, 마지막 하나가 FAIL하여 전체 테스트 결과가 FAIL로 발생하는 것을 확인할 수 있다.</p>\n<p>testing 패키지는 벤치마크 테스트 기능도 제공한다. _test.go 파일에 이름은 Benchmark로 시작하고 *testing.B를 매개변수로 받는 함수가 있으면 Go는 이 함수를 벤치마크 함수로 인식한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"go\"><pre class=\"language-go\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token function\">BenchmarkLenForString</span><span class=\"token punctuation\">(</span>b <span class=\"token operator\">*</span>testing<span class=\"token punctuation\">.</span>B<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    b<span class=\"token punctuation\">.</span><span class=\"token function\">StopTimer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    v <span class=\"token operator\">:=</span> <span class=\"token function\">make</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token operator\">:=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span> <span class=\"token punctuation\">{</span>\n        v<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> strconv<span class=\"token punctuation\">.</span><span class=\"token function\">Itoa</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n    b<span class=\"token punctuation\">.</span><span class=\"token function\">StartTimer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token operator\">:=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> b<span class=\"token punctuation\">.</span>N<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">Len</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">[</span>i<span class=\"token operator\">%</span><span class=\"token number\">1000000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 함수는 시작 부분에서 타이머를 멈추게 했다(b.StopTimer()). 벤치마크 테스트를 위한 테스트 데이터를 생성하는 시간은 측정되지 않게 하기 위해서다. 테스트 데이터 생성이 끝난 후에는 다시 타이머를 시작하게 했다(b.StartTimer()).</p>\n<p>벤치마크 테스트를 수행하려면 go test 명령어를 수행할 때 -bench 옵션과 벤치마크를 수행하려는 함수 이름에 대한 정규표현식을 함께 전달해야 한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">go <span class=\"token builtin class-name\">test</span> <span class=\"token parameter variable\">-test.bench</span><span class=\"token operator\">=</span>.</code></pre></div>","frontmatter":{"title":"[Go 언어 문법 정리] 06. 패키지","date":"June 11, 2022","description":null}},"previous":{"fields":{"slug":"/web/jwt&paesto/"},"frontmatter":{"title":"[Web] JWT Token과 PASETO"}},"next":{"fields":{"slug":"/web/jwt&paesto/"},"frontmatter":{"title":"[Web] JWT Token과 PASETO"}}},"pageContext":{"id":"d65fb7ad-6ba8-5a0b-8db7-e21853659f67"}},"staticQueryHashes":["230163734","3589320610"],"slicesMap":{}}