{"componentChunkName":"component---src-templates-blog-post-js","path":"/kubernetes/k8s_jsonpath/","result":{"data":{"site":{"siteMetadata":{"title":"Devlog"}},"markdownRemark":{"id":"635c52a9-7751-5d0c-8428-071d0fb182e3","excerpt":"1. JSONPath k8s에서는 각종 오브젝트의 세팅 정보를 YAML과 JSON 형태로 보여주는 경우가 많다. 대부분의 매니페스트 파일들이 YAML 형식이지만, YAML은 JSON으로도 쉽게 변경 가능하다. k8s…","html":"<h1>1. JSONPath</h1>\n<p>k8s에서는 각종 오브젝트의 세팅 정보를 YAML과 JSON 형태로 보여주는 경우가 많다. 대부분의 매니페스트 파일들이 YAML 형식이지만, YAML은 JSON으로도 쉽게 변경 가능하다. k8s 오브젝트를 운영하면서 <code class=\"language-text\">kubectl get {obejct}</code> 명령어는 엄청 자주 사용하게 되는데, 특정 오브젝트의 핵심적인 정보들은 <code class=\"language-text\">kubectl get {obejct} -o=wide</code> 명령어를 사용하여 조회 가능하다. 하지만, 내가 보고 싶은 정보만을 가져오기 위해서는 <code class=\"language-text\">kubectl get {obejct} -o=jsonpath=</code> 옵션을 사용해야 한다. 이 옵션으로 조회하기 위해서는 Json path라는 쿼리 명령어를 사용해야 한다.</p>\n</br>\n<h2>1.1 JSONPath의 기본 문법</h2>\n<p>Json 파일은 key 와 value로 구성되며, key는 String 형식으로, value에는 Number, String, Boolean, Dictionary 형식으로 구성된다. 여기서 Dictionary란 key와 value로 구성된 Object이며, Json path는 특정 value를 찾아내기 위한 경로를 나타내는 표현식을 말한다.</p>\n<p>기본적으로는 아래와 같은 문법을 가진다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"vehicles\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"car\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"$20,000\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"wheels\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"model\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"X345ERT\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"front-right\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"model\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"X346GRX\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"front-left\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"model\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"X236DEM\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"rear-right\"</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"bus\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"$120,000\"</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n</br>\n<ul>\n<li>Json path에서 각 키 값을 통해 쿼리 가능하다.</li>\n</ul>\n<p></br> <code class=\"language-text\">vehicles.car</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"$20,000\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>가장 바깥쪽 중괄호<code class=\"language-text\">({})</code>는 Root를 의미한다.</li>\n</ul>\n<p></br> <code class=\"language-text\">$.vehicles.car.color</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token string\">\"blue\"</span> </code></pre></div>\n<ul>\n<li>Array 요소는 대괄호<code class=\"language-text\">[]</code>를 통해 접근 가능하다.</li>\n</ul>\n<p></br> <code class=\"language-text\">$.vehicles.car.wheels[1].model</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token string\">\"X346GRX\"</span></code></pre></div>\n<ul>\n<li>Array 요소의 Filter는 <code class=\"language-text\">?()</code>를 통해 가능하다. 각 요소를 나타내는 표현은 <code class=\"language-text\">@</code> 이다.</li>\n</ul>\n<p></br> <code class=\"language-text\">$.vehicles.car.wheels[?(@.location == \"rear-right\")]</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token string\">\"X236DEM\"</span></code></pre></div>\n</br>\n<h2>1.2 Wildcard</h2>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"vehicles\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"car\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"$20,000\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"wheels\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"model\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"X345ERT\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"front-right\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"K\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"model\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"X346GRX\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"front-left\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"K\"</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"bus\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"white\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"price\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"$120,000\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"wheels\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"model\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Z227KLJ\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"front-right\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"N\"</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"model\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Z226KLJ\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"location\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"front-left\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"brand\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"K\"</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>모든 요소를 표현할 때는 와일드카드<code class=\"language-text\">(*)</code>를 사용한다.</li>\n</ul>\n<p></br> <code class=\"language-text\">$.vehicles.*.color.</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span> <span class=\"token string\">\"blue\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"white\"</span> <span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>List 내부에서도 와일드카드<code class=\"language-text\">(*)</code>를 사용하여 접근 가능하다.</li>\n</ul>\n<p></br> <code class=\"language-text\">$.vehicles.*.wheels[*].model</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span> <span class=\"token string\">\"X345ERT\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"X346GRX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Z227KLJ\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Z226KLJ\"</span> <span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>Filter 내부의 And 조건은 <code class=\"language-text\">&amp;&amp;</code>를 통해서 가능하다.</li>\n</ul>\n<p></br> <code class=\"language-text\">$.vehicles.*.wheels[?(@.location == \"front-left\" &amp;&amp; @.brand == \"K\")]</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span> <span class=\"token string\">\"X346GRX\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Z226KLJ\"</span> <span class=\"token punctuation\">]</span></code></pre></div>\n</br>\n<h2>1.3 Lists</h2>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n  <span class=\"token string\">\"Apple\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Google\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Microsoft\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Amazon\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Facebook\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Coca-Cola\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Samsung\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Disney\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Toyota\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"McDonald's\"</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>List에서 특정 범위 내의 요소는 <code class=\"language-text\">(:)</code>를 통해 조회 가능하다. 예를 들어, [0:8:2]의 경우 0번째 요소부터, 8번째 요소까지, 2번씩 건너뛰어서 조회를 하게 된다.</li>\n</ul>\n<p></br> <code class=\"language-text\">$[0:8:2]</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n  <span class=\"token string\">\"Apple\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Microsoft\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Facebook\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Samsung\"</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<ul>\n<li>뒤에서부터 조회할 때는 -1부터 시작하게 된다. 즉, 항상 맨 마지막 요소를 조회하기 위해서는 -1 인덱스를 사용한다.</li>\n</ul>\n<p></br> <code class=\"language-text\">$[-3:]</code></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n  <span class=\"token string\">\"Disney\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"Toyota\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"McDonald's\"</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<div align=\"left\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 443px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/8f6f16ec73159425e2f0b42c41af0108/a120c/jsonpath-lists.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 108.22784810126582%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADMUlEQVR42q1V227bOhDM58QSuReSkm05SZ30JOj9ghYt0P7/d2xnl1LjU+A8nT4QpmhxODszS13lnI2IbBgGG8fxf48rFbVSq11f7wA62rAbAjzG7r8PGRL+z/4e9iWMDZCXYvq6WTmq1aamRUwKGwuZNjatbONwAeZzSpaPYnlPxq/U8gvMG8V/V/xQTX8cjPGCMtty22w6NIDiuQEcmwtn2w0XgJyMHqvJQ7HybW/8frK8SFR0RScwfFet3IJh0QBxVnUuJipWZrWGteRlXgKe1fikJh9nIzCkDTDdYPHTZLywCXuJOADAZdIAJJReAMCULYFtsMQvPxbj87r3ESWfIM0GmMFQjmzHZbJ2KKGjFgBVsXkPpmBY9/2QJtkyDsggEBp+rpYOhPkKyChVvs4mC36hVTckx5wZxgCUsZZSZydptOSMXcN7HAb9BHPXsDPEJL8tRjClTGz7k5tSAqj6cFYKVsMaq1XDfAM59hhnCbB82Eo+SeigMKfoGhnlXnbtGirWKsr2KPmmkUeje0h1h/fftzDlN8Pswv6E9QCuStagmSKPpbnDmINhxZofMukYbvfYFMsvAfgFLuPXGY/XDggNCSUXRMAZuhEeG4EpjFI97CQJjuc4TNztteQ0471/oJ+bspWczzj9e2coLFGeRJnYkCG+cMhQJjBCrCqNcQA9Qfd77PnQjDHPp43hubtc0ILOZjpU2y8NpbohxWYYNM09Lmkcnk25k4gOf0CX3F6Y4g/0Ga3mpqxsfBBKJsSmAUwrGOMyyOm5U1w/wl5+XY0eNHq7AyLQ9KTRy5sRdRYAwQQPM54nmEXI4dZ63jEBhr3yCmQiQitDAnX+isXFDen9G8GGjrLpB4fzH7dNRMV1f/LY6EXJL1zDyQhOCTYKHJ7AqlSs+3DWXuKqn18A4TK0p1vE6o0DopOOntHRAXEKrqByU9G3NTTz7tDSu4W193TFurOeZ2iGNU+H6+Yt6IAuXe8UNHiC7anmuBBcvzABTLWtl2zzjsnRKYQcjohTWjpIvtN+UbTcL1j/BFRtttvtnq/+6NvL5yFeHsbh39+e9MevfwKIPMj61z5SvwC7X7DqzRAgSAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"jsonpath lists\" title=\"\" src=\"/static/8f6f16ec73159425e2f0b42c41af0108/a120c/jsonpath-lists.png\" srcset=\"/static/8f6f16ec73159425e2f0b42c41af0108/c26ae/jsonpath-lists.png 158w,\n/static/8f6f16ec73159425e2f0b42c41af0108/6bdcf/jsonpath-lists.png 315w,\n/static/8f6f16ec73159425e2f0b42c41af0108/a120c/jsonpath-lists.png 443w\" sizes=\"(max-width: 443px) 100vw, 443px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n</div>\n</br>\n<h2>1.4 K8S에서의 JSONPath</h2>\n<p>k8s 공식 문서에서 설명하는 JSONPath는 아래와 같다.</p>\n<ol>\n<li>큰따옴표를 사용하여 JSONPath 표현식 내부의 텍스트를 인용한다.</li>\n<li>목록을 반복하려면 range, end 오퍼레이터를 사용한다.</li>\n<li>목록에서 뒤로 이동하려면 negative slice 인덱스를 사용한다. negative 인덱스는 목록을 \"순환(wrap around)\" 하지 않으며, -index + listLength >= 0 인 한 유효하다.</li>\n<li>표현식은 항상 루트 오브젝트에서 시작하므로 $ 오퍼레이터는 선택 사항이다.</li>\n<li>결과 오브젝트는 String() 함수로 출력된다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"kind\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"List\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"items\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"kind\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"None\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"metadata\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"capacity\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"cpu\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"4\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"addresses\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"LegacyHostIP\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"address\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"kind\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"None\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"metadata\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"127.0.0.2\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"status\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"capacity\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">{</span><span class=\"token property\">\"cpu\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"8\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"addresses\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>\n          <span class=\"token punctuation\">{</span><span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"LegacyHostIP\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"address\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"127.0.0.2\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">{</span><span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"another\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"address\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"127.0.0.3\"</span><span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"users\"</span><span class=\"token operator\">:</span><span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"myself\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"user\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"e2e\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"user\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token property\">\"username\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"admin\"</span><span class=\"token punctuation\">,</span> <span class=\"token property\">\"password\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"secret\"</span><span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<table>\n<thead>\n<tr>\n<th>기능</th>\n<th>설명</th>\n<th>예시</th>\n<th>결과</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>text</td>\n<td>일반 텍스트</td>\n<td>kind is {.kind}</td>\n<td>kind is List</td>\n</tr>\n<tr>\n<td>@</td>\n<td>현재 오브젝트</td>\n<td>{@}</td>\n<td>입력과 동일</td>\n</tr>\n<tr>\n<td>. or []</td>\n<td>자식 오퍼레이터</td>\n<td>{.kind}, {['kind']} or {['name.type']}</td>\n<td>List</td>\n</tr>\n<tr>\n<td>..</td>\n<td>재귀 하향(recursive descent)</td>\n<td>{..name}</td>\n<td>127.0.0.1 127.0.0.2 myself e2e</td>\n</tr>\n<tr>\n<td>*</td>\n<td>와일드 카드. 모든 오브젝트 가져오기</td>\n<td>{.items[*].metadata.name}</td>\n<td>[127.0.0.1 127.0.0.2]</td>\n</tr>\n<tr>\n<td>[start:end:step]</td>\n<td>아래 첨자 오퍼레이터</td>\n<td>{.users[0].name}</td>\n<td>myself</td>\n</tr>\n<tr>\n<td>[,]</td>\n<td>조합 오퍼레이터</td>\n<td>{.items[*]['metadata.name', 'status.capacity']}</td>\n<td>127.0.0.1 127.0.0.2 map[cpu:4] map[cpu:8]</td>\n</tr>\n<tr>\n<td>?()</td>\n<td>필터</td>\n<td>{.users[?(@.name==\"e2e\")].user.password}</td>\n<td>secret</td>\n</tr>\n<tr>\n<td>range, end</td>\n<td>반복 목록</td>\n<td>{range .items[*]}[{.metadata.name}, {.status.capacity}] {end}</td>\n<td>[127.0.0.1, map[cpu:4]] [127.0.0.2, map[cpu:8]]</td>\n</tr>\n<tr>\n<td>''</td>\n<td>해석된 문자열 인용</td>\n<td>{range .items[*]}{.metadata.name}{'\\t'}{end}</td>\n<td>127.0.0.1 127.0.0.2</td>\n</tr>\n</tbody>\n</table>\n<p>kubectl 명령어에서는 JSONPATH를 지원하는데, 다음과 같은 방법으로 사용 가능하다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- JSONPATH를 사용할 kubectl 명령어를 식별한다.\n- json output 결과의 위치를 확인한다.\n- JSONPATH를 설정한다.\n- `kubectl get {object} -o=jsonpath=`에 생성한 JSONPATH를 붙여넣는다.</code></pre></div>\n</br>\n<ul>\n<li>각 결과를 별도 row로 표현하려면 <code class=\"language-text\">{\\n}</code>을 사용한다.</li>\n</ul>\n<p></br> <code class=\"language-text\">kubectl get nodes -o=jsonpath='{.items[*].metadata.name}{\"\\n\"}{.items[*].status.capacity.cpu}'</code></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">master  node01\n<span class=\"token number\">4</span>       <span class=\"token number\">4</span></code></pre></div>\n</br>\n<ul>\n<li>위와 동일한 결과를 <code class=\"language-text\">range</code>를 통해서도 출력 가능하다.</li>\n</ul>\n<p></br> <code class=\"language-text\">kubectl get nodes -o=jsonpath='{range .items[*]}{.metadata.name}{\"\\t\"}{.status.capacity.cpu}{\"\\n\"}{end}'</code></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">master  <span class=\"token number\">4</span>\nnode01  <span class=\"token number\">4</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">-o=jsonpath</code> 옵션 말고, <code class=\"language-text\">-o=custom-columns</code> 옵션을 통해서도 사용 가능하다.</li>\n</ul>\n<p></br> <code class=\"language-text\">kubectl get nodes -o=custom-columns=NODE:.metadata.name,CPU:.status.capacity.cpu</code></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">NODE    CPU\nmaster  <span class=\"token number\">4</span>\nnode01  <span class=\"token number\">4</span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">--sort-by=</code> 옵션을 통해서는 특정 필드로 정렬 가능하다.</li>\n</ul>\n<p></br> <code class=\"language-text\">kubectl get nodes -o=custom-columns=NODE:.metadata.name,CPU:.status.capacity.cpu --sort-by=.status.capacity.cpu</code></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">NODE    CPU\nmaster  <span class=\"token number\">2</span>\nnode01  <span class=\"token number\">3</span>\nnode02  <span class=\"token number\">4</span></code></pre></div>","frontmatter":{"title":"[k8s] Jsonpath","date":"August 11, 2023","description":null}},"previous":{"fields":{"slug":"/db/acid/"},"frontmatter":{"title":"[Database] ACID 원칙"}},"next":{"fields":{"slug":"/embedded/micropython_mip/"},"frontmatter":{"title":"[MicroPython] mip를 통한 MicroPython 라이브러리 받기"}}},"pageContext":{"id":"635c52a9-7751-5d0c-8428-071d0fb182e3","previousPostId":"97212948-f900-5ae4-a8de-037a421bb387","nextPostId":"5d6d49be-b2d7-5215-85aa-cfe0ca2365cb"}},"staticQueryHashes":["2841359383","3257411868"],"slicesMap":{}}